<!DOCTYPE html>
<html>
  <head>
    <title>MDG ATMe Calculator</title>
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@2.51.6/dist/full.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-base-200">
    <div class="navbar bg-base-100">
      <div class="flex-1">
        <a
          class="btn btn-ghost normal-case text-xl"
          href="https://www.mdgfog.com/en/atme" target="_blank"
          >MDG ATMe consumption calculator</a
        >
      </div>
      <div class="flex-none">
        <p>Logic by Adam Davies. Site by Sam Clay</p>
      </div>
    </div>
    <div class="p-10">
      <form>
        <div class="grid grid-cols-1 gap-2">
          <!-- 1 -->
          <div class="grid grid-cols-4 gap-2">
            <div>
              <label class="label">
                <span class="label-text">Run Level (%)</span>
              </label>
              <select
                class="select select-bordered w-full max-w-xs select-primary select-sm"
                onchange="calculate(1)"
                id="runlevel1"
              >
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="75">75</option>
                <option value="100">100</option>
              </select>
            </div>
            <div>
              <label class="label">
                <span class="label-text">Run Time (hours)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-primary input-sm"
                oninput="calculate(1)"
                id="runtime1"
                value="0"
                onblur="checkInputValue(1)"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Fluid Used (ml)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="fluid1"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Gas Used (kg)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="gas1"
              />
            </div>
          </div>

          <!-- 2    -->
          <div class="grid grid-cols-4 gap-2">
            <div>
              <label class="label">
                <span class="label-text">Run Level (%)</span>
              </label>
              <select
                class="select select-bordered w-full max-w-xs select-primary select-sm"
                onchange="calculate(2)"
                id="runlevel2"
              >
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="75">75</option>
                <option value="100">100</option>
              </select>
            </div>
            <div>
              <label class="label">
                <span class="label-text">Run Time (hours)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-primary input-sm"
                oninput="calculate(2)"
                id="runtime2"
                value="0"
                onblur="checkInputValue(2)"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Fluid Used (ml)</span>
              </label>
              <input
                type="text"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="fluid2"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Gas Used (kg)</span>
              </label>
              <input
                type="text"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="gas2"
              />
            </div>
          </div>

          <!-- 3 -->

          <div class="grid grid-cols-4 gap-2">
            <div>
              <label class="label">
                <span class="label-text">Run Level (%)</span>
              </label>
              <select
                class="select select-bordered w-full max-w-xs select-primary select-sm"
                onchange="calculate(3)"
                id="runlevel3"
              >
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="75">75</option>
                <option value="100">100</option>
              </select>
            </div>
            <div>
              <label class="label">
                <span class="label-text">Run Time (hours)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-primary input-sm"
                oninput="calculate(3)"
                id="runtime3"
                value="0"
                onblur="checkInputValue(3)"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Fluid Used (ml)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="fluid3"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Gas Used (kg)</span>
              </label>
              <input
                type="text"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="gas3"
              />
            </div>
          </div>

          <!-- 4  -->

          <div class="grid grid-cols-4 gap-2">
            <div>
              <label class="label">
                <span class="label-text">Run Level (%)</span>
              </label>
              <select
                class="select select-bordered w-full max-w-xs select-primary select-sm"
                onchange="calculate(4)"
                id="runlevel4"
              >
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="75">75</option>
                <option value="100">100</option>
              </select>
            </div>
            <div>
              <label class="label">
                <span class="label-text">Run Time (hours)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-primary input-sm"
                oninput="calculate(4)"
                id="runtime4"
                value="0"
                onblur="checkInputValue(4)"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Fluid Used (ml)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="fluid4"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Gas Used (kg)</span>
              </label>
              <input
                type="text"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="gas4"
              />
            </div>
          </div>

          <!-- 5 -->

          <div class="grid grid-cols-4 gap-2">
            <div>
              <label class="label">
                <span class="label-text">Run Level (%)</span>
              </label>
              <select
                class="select select-bordered w-full max-w-xs select-primary select-sm"
                onchange="calculate(5)"
                id="runlevel5"
              >
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="75">75</option>
                <option value="100">100</option>
              </select>
            </div>
            <div>
              <label class="label">
                <span class="label-text">Run Time (hours)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-primary input-sm"
                oninput="calculate(5)"
                id="runtime5"
                value="0"
                onblur="checkInputValue(5)"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Fluid Used (ml)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="fluid5"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Gas Used (kg)</span>
              </label>
              <input
                type="text"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="gas5"
              />
            </div>
          </div>

          <!-- 6 -->

          <div class="grid grid-cols-4 gap-2">
            <div>
              <label class="label">
                <span class="label-text">Run Level (%)</span>
              </label>
              <select
                class="select select-bordered w-full max-w-xs select-primary select-sm"
                onchange="calculate(6)"
                id="runlevel6"
              >
                <option value="25">25</option>
                <option value="50">50</option>
                <option value="75">75</option>
                <option value="100">100</option>
              </select>
            </div>
            <div>
              <label class="label">
                <span class="label-text">Run Time (hours)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-primary input-sm"
                oninput="calculate(6)"
                id="runtime6"
                value="0"
                onblur="checkInputValue(6)"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Fluid Used (ml)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="fluid6"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Gas Used (kg)</span>
              </label>
              <input
                type="text"
                class="input input-bordered w-full max-w-xs input-warning input-sm"
                readonly
                id="gas6"
              />
            </div>
          </div>

          <!-- 7 -->

          <!-- 8 -->

          <!-- 9 -->

          <!-- 10 -->

          <!-- TOTALS -->
          <div class="divider"></div>

          <div class="grid grid-cols-4 gap-2">
            <div></div>
            <div></div>
            <div>
              <label class="label">
                <span class="label-text">Total Fluid (ml)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-success input-sm"
                readonly
                id="totalFluid"
              />
            </div>
            <div>
              <label class="label">
                <span class="label-text">Total Gas (kg)</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-success input-sm"
                readonly
                id="totalGas"
              />
            </div>
          </div>
          <div class="grid grid-cols-4 gap-2">
            <div></div>
            <div></div>
            <div></div>
            <div class="form-control">
              <label class="label">
                <span class="label-text">No. standard TSL cylinders</span>
              </label>
              <input
                type="number"
                class="input input-bordered w-full max-w-xs input-success input-sm"
                readonly
                id="gasCylinders"
              />
              <label class="label">
                <span class="label-text text-danger"
                  >Note: TSL stock "VB" sized cylinders. They weigh approx. 22KG
                  with 6KG of CO<sub>2</sub> inside.
                </span>
              </label>
            </div>
          </div>
        </div>
      </form>
    </div>
  </body>
  <script>
    //  RL   |   Fluid  |   Gas
    //--------------------------------
    //  25   |   27.5   |   0.09
    //  50   |   55     |   0.18
    //  75   |   77.5   |   0.27
    //  100  |   100    |   0.36

    function calculate(i) {
      //get runtime from specific cue's runtime input
      let runtime = parseFloat(document.getElementById(`runtime` + i).value);
      console.log(`runtime ` + i + ` = ` + runtime);

      //get run level from specific cue's run level select input
      let runlevel = parseInt(document.getElementById(`runlevel` + i).value);
      console.log(`runlevel ` + i + ` = ` + runlevel);

      // if RT > 1 -> calculate

      let fluidused;
      let gasused;
      switch (runlevel) {
        case 25:
          fluidused = 27.5 * runtime;
          gasused = 0.09 * runtime;
          break;
        case 50:
          fluidused = 55 * runtime;
          gasused = 0.18 * runtime;
          break;
        case 75:
          fluidused = 77.5 * runtime;
          gasused = 0.27 * runtime;
          break;
        case 100:
          fluidused = 100 * runtime;
          gasused = 0.36 * runtime;
          break;
      }
      console.log({ fluidused });
      console.log({ gasused });
      //put fluid and gas values back in specific cue's output boxes

      document.getElementById(`fluid` + i).value = fluidused;
      document.getElementById(`gas` + i).value = gasused;

      totals();
    }

    function totals() {
      let totalFluid = 0;
      let fluidIDs = [
        "fluid1",
        "fluid2",
        "fluid3",
        "fluid4",
        "fluid5",
        "fluid6",
      ];
      for (let i = 0; i < fluidIDs.length; i++) {
        const input = document.getElementById(fluidIDs[i]);
        const value = input && input.value ? parseFloat(input.value) : 0;
        totalFluid += value;
      }

      let totalGas = 0;
      let gasIDs = ["gas1", "gas2", "gas3", "gas4", "gas5", "gas6"];
      for (let i = 0; i < gasIDs.length; i++) {
        const input = document.getElementById(gasIDs[i]);
        const value = input && input.value ? parseFloat(input.value) : 0;
        totalGas += value;
      }

      let cylinders = Math.ceil(totalGas / 6);
      document.getElementById("totalFluid").value = totalFluid;
      document.getElementById("totalGas").value = totalGas;
      document.getElementById("gasCylinders").value = cylinders;
    }

    function checkInputValue(i) {
      //get input
      let input = document.getElementById(`runtime` + i);
      if (input.value === "") {
        input.value = "0";
        calculate(i);
      }
    }
  </script>
</html>
